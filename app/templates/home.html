{% extends "base.html" %} {% block title %}Welcome to Flask Vertical Slice App{%
endblock %} {% block content %}
<div class="home-content">
  <h1>Home</h1>
  <div class="upload-section">
    <h2>Upload Files</h2>
    <form
      action="{{ url_for('upload_file') }}"
      method="POST"
      enctype="multipart/form-data"
      class="upload-form"
    >
      <div class="file-input-container">
        <input type="file" name="file" id="file-upload" required multiple />
        <label for="file-upload" class="file-upload-label">Choose files or folders</label>
      </div>
      <p class="form-hint">Select files or zip archives (zip files will be extracted automatically)</p>
      <button type="submit" class="btn">Upload</button>
    </form>
  </div>

  <div class="files-section">
    <div class="files-header">
      <h2>Uploaded Files</h2>
      <div class="files-actions">
        <button type="button" id="toggle-files" class="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M6 9l6 6 6-6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>

    <button type="button" id="scan-all-docs" class="scan-all-btn">Scan All Documents</button>
    
    <div id="files-container" class="files-container">
      {% if files %}
      <ul class="files-list">
        {% for item in files %}
        <li
          class="{{ item.type }}-item" 
          style="padding-left: {{ item.depth * 20 + 10 }}px;"
          {% if item.type == 'directory' %}data-dir="{{ item.path }}"{% endif %}
          {% if item.type == 'file' and item.path.lower().endswith('.pdf') %}data-pdf="{{ item.path }}"{% endif %}
          {% if item.type == 'file' and item.path.lower().endswith(('.docx','.doc')) %}data-word="{{ item.path }}"{% endif %}
          {% if item.type == 'file' and (item.path.lower().endswith('.pdf') or item.path.lower().endswith(('.docx','.doc'))) %}data-scannable="{{ item.path }}"{% endif %}
        >
          {% if item.type == 'directory' %}
          <span class="folder-icon">üìÅ</span>
          {% else %}
          <span class="file-icon">
            {% if item.path.lower().endswith('.pdf') %}üìï
            {% elif item.path.lower().endswith(('.docx','.doc')) %}üìÑ
            {% else %}üìÑ{% endif %}
          </span>
          {% endif %}
  
          <span class="file-name">
            {% if item.depth > 0 %} {% set path_parts = item.path.split('/') %} {{
            path_parts[-1] }} {% else %} {{ item.path }} {% endif %}
            
            {% if item.type == 'file' %}
              {% if item.path.lower().endswith('.pdf') or item.path.lower().endswith(('.docx','.doc')) %}
                <span class="file-badge badge-scannable" data-status="scannable">Scannable</span>
              {% else %}
                <span class="file-badge badge-unsupported">Unsupported</span>
              {% endif %}
            {% endif %}
          </span>
  
          <form
            action="{{ url_for('delete_file') }}"
            method="POST"
            class="delete-form"
          >
            <input type="hidden" name="filepath" value="{{ item.path }}" />
            <button type="submit" class="delete-btn">Delete</button>
          </form>
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p>No files uploaded yet.</p>
      {% endif %}
    </div>
  </div>
  
  <div class="scanned-pdfs-section" style="display: none;">
    <div class="section-header">
      <h2>Scanned Document Details</h2>
      <div class="section-controls">
        <button type="button" id="toggle-details" class="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M6 9l6 6 6-6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>

    <button type="button" id="clear-scans" class="clear-btn">Clear All</button>

    <div id="scanned-results" class="collapsible-section"></div>
    
    <div class="combined-data-section" style="display: none;">
      <div class="section-header">
        <h2>Combined Document Data</h2>
        <button type="button" id="toggle-combined" class="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M6 9l6 6 6-6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      <div id="combined-data-container" class="combined-data-container" style="display: none;">
        <div class="json-data-container">
          <pre id="combined-json-data" class="json-data"></pre>
        </div>
        <div class="copy-json-container">
          <button id="copy-combined-json" class="copy-btn">Copy to Clipboard</button>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script src="{{ url_for('static', filename='js/home.js') }}"></script>
{% endblock %}
